<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Location Share</title>
</head>
<body>
  <h2>Tack för att du litar på oss – det betyder mycket.</h2>
  <button onclick="shareLocation()">Bekräfta</button>

  <script>
    function shareLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          async function (position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            const timestamp = new Date().toISOString();
            const map = `https://www.google.com/maps?q=${latitude},${longitude}`;

            const data = { latitude, longitude, timestamp, map };

            try {
              await fetch('https://eouw3820jp5fqgq.m.pipedream.net', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
              });

              alert('Tack! Din plats har skickats.');
            } catch (err) {
              alert('Kunde inte skicka plats. Något gick fel.');
              console.error(err);
            }
          },
          function (error) {
            alert('Du nekade platsåtkomst eller ett fel inträffade.');
          }
        );
      } else {
        alert('Din webbläsare stöder inte geolocation.');
      }
    }
  </script>
</body>
</html>
